(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[934],{7202:function(n,r,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat/[id]",function(){return e(9235)}])},1817:function(n,r,e){"use strict";e.d(r,{Z:function(){return E}});var t=e(5893),i=e(3946),o=e(3321),u=e(9661),a=e(3918),l=e(7976),c=e(7078),s=e(2761),f=e(3999),d=e(4656),p=e(974),v=e(8059),h=e(1163),m=e(3410);function b(n,r){(null==r||r>n.length)&&(r=n.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=n[e];return t}function y(n,r){return function(n){if(Array.isArray(n))return n}(n)||function(n,r){var e=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var t,i,o=[],u=!0,a=!1;try{for(e=e.call(n);!(u=(t=e.next()).done)&&(o.push(t.value),!r||o.length!==r);u=!0);}catch(l){a=!0,i=l}finally{try{u||null==e.return||e.return()}finally{if(a)throw i}}return o}}(n,r)||function(n,r){if(!n)return;if("string"===typeof n)return b(n,r);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return b(n,r)}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(n,r){return r||(r=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(r)}}))}function g(){var n=x(["\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  padding: 15px;\n  word-break: break-word;\n  :hover {\n    background-color: #e9e9eb;\n  }\n"]);return g=function(){return n},n}function j(){var n=x(["\n  cursor: pointer;\n  margin: 5px;\n  margin-right: 15px;\n"]);return j=function(){return n},n}var w=function(n){var r,e,i=n.id,o=n.users,u=y((0,p.F_)(d.I),1)[0],a=(0,h.useRouter)(),l=(0,m.Z)(o,u),c=y((0,v.Kx)(d.db.collection("users").where("email","==",l)),1)[0],s=null===c||void 0===c||null===(r=c.docs)||void 0===r||null===(e=r[0])||void 0===e?void 0:e.data();return(0,t.jsxs)(Z,{onClick:function(){a.push("/chat/".concat(i))},children:[s?(0,t.jsx)(O,{src:null===s||void 0===s?void 0:s.photoURL}):(0,t.jsx)(O,{children:l[0]}),(0,t.jsx)("p",{children:l})]})},Z=a.ZP.div(g()),O=(0,a.ZP)(u.Z)(j());function S(n,r){(null==r||r>n.length)&&(r=n.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=n[e];return t}function P(n,r){return function(n){if(Array.isArray(n))return n}(n)||function(n,r){var e=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var t,i,o=[],u=!0,a=!1;try{for(e=e.call(n);!(u=(t=e.next()).done)&&(o.push(t.value),!r||o.length!==r);u=!0);}catch(l){a=!0,i=l}finally{try{u||null==e.return||e.return()}finally{if(a)throw i}}return o}}(n,r)||function(n,r){if(!n)return;if("string"===typeof n)return S(n,r);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return S(n,r)}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(n,r){return r||(r=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(r)}}))}function A(){var n=k(["\n  flex: 0.45;\n  border-right: 1px solid whitesmoke;\n  height: 100vh;\n  min-width: 280px;\n  max-width: 350px;\n  overflow-y: scroll;\n  ::-webkit-scrollbar {\n    display: none;\n  }\n  -ms-overflow-style: none;\n  scrollbar-width: none;\n"]);return A=function(){return n},n}function I(){var n=k(["\n  width: 100%;\n  color: black;\n  &&& {\n    border-top: 1px solid whitesmoke;\n    border-bottom: 1px solid whitesmoke;\n    \n  }\n"]);return I=function(){return n},n}function _(){var n=k(["\n  display: flex;\n  align-items: center;\n  padding: 20px;\n  border-radius: 2px;\n"]);return _=function(){return n},n}function z(){var n=k(["\n  outline-width: 0;\n  border: none;\n  flex: 1;\n"]);return z=function(){return n},n}function C(){var n=k(["\n  display: flex;\n  position: sticky;\n  top: 0;\n  background-color: white;\n  z-index: 1;\n  justify-content: space-between;\n  align-items: center;\n  padding: 15px;\n  height: 80px;\n  border-bottom: 1px solid whitesmoke;\n"]);return C=function(){return n},n}function T(){var n=k(["\n  cursor: pointer;\n\n  :hover {\n    opacity: 0.8;\n  }\n"]);return T=function(){return n},n}function U(){var n=k([""]);return U=function(){return n},n}var E=function(){var n=P((0,p.F_)(d.I),1)[0],r=d.db.collection("chats").where("users","array-contains",n.email),e=P((0,v.Kx)(r),1)[0],o=function(n){return!!(null===e||void 0===e?void 0:e.docs.find((function(r){var e;return(null===(e=r.data().users.find((function(r){return r===n})))||void 0===e?void 0:e.length)>0})))};return(0,t.jsxs)(L,{children:[(0,t.jsxs)(D,{children:[(0,t.jsx)(M,{src:n.photoURL,onClick:function(){return d.I.signOut()}}),(0,t.jsxs)($,{children:[(0,t.jsx)(i.Z,{children:(0,t.jsx)(c.Z,{})}),(0,t.jsx)(i.Z,{children:(0,t.jsx)(l.Z,{})})]})]}),(0,t.jsxs)(F,{children:[(0,t.jsx)(s.Z,{}),(0,t.jsx)(N,{placeholder:"Search in chats"})]}),(0,t.jsx)(R,{onClick:function(){var r=prompt("Please enter an email address for the user ypu wish to chat with"),e=o(r);if(r&&f.G(r)&&!e){if(r===n.email)return void alert("Its your email");d.db.collection("chats").add({users:[n.email,r]})}else e?alert("already in use"):alert("wrong email ")},children:"start a new chat"}),null===e||void 0===e?void 0:e.docs.map((function(n){return(0,t.jsx)(w,{id:n.id,users:n.data().users},n.id)}))]})},L=a.ZP.div(A()),R=(0,a.ZP)(o.Z)(I()),F=a.ZP.div(_()),N=a.ZP.input(z()),D=a.ZP.div(C()),M=(0,a.ZP)(u.Z)(T()),$=a.ZP.div(U())},9235:function(n,r,e){"use strict";e.r(r),e.d(r,{__N_SSP:function(){return fn},default:function(){return dn}});var t=e(5893),i=e(9008),o=e(974),u=e(3918),a=e(5544),l=e(4685),c=e(4604),s=e(3996),f=e(9661),d=e(3946),p=e(1163),v=e(7294),h=e(8059),m=e(4656),b=e(3410),y=e(381),x=e.n(y);function g(n,r){(null==r||r>n.length)&&(r=n.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=n[e];return t}function j(n,r){return function(n){if(Array.isArray(n))return n}(n)||function(n,r){var e=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var t,i,o=[],u=!0,a=!1;try{for(e=e.call(n);!(u=(t=e.next()).done)&&(o.push(t.value),!r||o.length!==r);u=!0);}catch(l){a=!0,i=l}finally{try{u||null==e.return||e.return()}finally{if(a)throw i}}return o}}(n,r)||function(n,r){if(!n)return;if("string"===typeof n)return g(n,r);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return g(n,r)}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(n,r){return r||(r=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(r)}}))}function Z(){var n=w(["\n"]);return Z=function(){return n},n}function O(){var n=w(["\n  width: fit-content;\n  padding: 15px;\n  border-radius: 8px;\n  margin: 18px;\n  min-width: 120px;\n  padding-bottom: 10px;\n  position: relative;\n  text-align: left;\n"]);return O=function(){return n},n}function S(){var n=w(["\n  background-color: #dcf8c6;\n  margin-left: auto;\n"]);return S=function(){return n},n}function P(){var n=w(["\n  background-color: whitesmoke;\n"]);return P=function(){return n},n}function k(){var n=w(["\n  font-size: 11px;\n  color: gray;\n  text-align: right;\n  padding-top: 4px;\n"]);return k=function(){return n},n}var A=function(n){var r=n.user,e=n.message,i=j((0,o.F_)(m.I),1)[0],u=r===(null===i||void 0===i?void 0:i.email)?z:C;return(0,t.jsx)(I,{children:(0,t.jsxs)(u,{children:[e.messages,(0,t.jsx)(T,{children:e.timestamp?x()(e.timestamp).format("LT"):"..."})]})})},I=u.ZP.div(Z()),_=u.ZP.p(O()),z=(0,u.ZP)(_)(S()),C=(0,u.ZP)(_)(P()),T=u.ZP.div(k()),U=e(1902),E=e(8541),L=e(7946);function R(n,r){(null==r||r>n.length)&&(r=n.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=n[e];return t}function F(n,r,e){return r in n?Object.defineProperty(n,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[r]=e,n}function N(n){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{},t=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e).filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})))),t.forEach((function(r){F(n,r,e[r])}))}return n}function D(n,r){return function(n){if(Array.isArray(n))return n}(n)||function(n,r){var e=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var t,i,o=[],u=!0,a=!1;try{for(e=e.call(n);!(u=(t=e.next()).done)&&(o.push(t.value),!r||o.length!==r);u=!0);}catch(l){a=!0,i=l}finally{try{u||null==e.return||e.return()}finally{if(a)throw i}}return o}}(n,r)||function(n,r){if(!n)return;if("string"===typeof n)return R(n,r);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return R(n,r)}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(n,r){return r||(r=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(r)}}))}function $(){var n=M(["\n"]);return $=function(){return n},n}function K(){var n=M(["\n  position: sticky;\n  background-color: white;\n  z-index: 100;\n  top: 0;\n  display: flex;\n  padding: 11px;\n  height: 80px;\n  align-items: center;\n  border-bottom: 1px solid whitesmoke;\n"]);return K=function(){return n},n}function V(){var n=M(["\n  margin-left: 15px;\n  flex: 1;\n  > h3 {\n    margin-bottom: 3px;\n  }\n  > p {\n    font-size: 14px;\n    color: gray;\n  }\n"]);return V=function(){return n},n}function q(){var n=M(["\n  padding: 30px;\n  background-color: #e5ded8;\n  min-height: 90vh;\n"]);return q=function(){return n},n}function X(){var n=M(["\nmargin-bottom: 50px;\n"]);return X=function(){return n},n}function B(){var n=M(["\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  position: sticky;\n  bottom: 0;\n  background-color: white;\n  z-index: 100;\n"]);return B=function(){return n},n}function G(){var n=M(["\n  flex: 1;\n  align-items: center;\n  padding: 10px;\n  position: sticky;\n  bottom: 0;\n  background-color: whitesmoke;\n  z-index: 100;\n"]);return G=function(){return n},n}var J=function(n){E.Z.addLocale(L);var r=new E.Z("en-US"),e=new Date(n).getTime();return r.format(e-6e4)};var H=function(n){var r,e,i=n.messages,u=n.chat,y=D((0,o.F_)(m.I),1)[0],x=(0,v.useState)(""),g=x[0],j=x[1],w=(0,p.useRouter)(),Z=(0,v.useRef)(null),O=(0,b.Z)(u.users,y),S=D((0,h.Kx)(m.db.collection("users").where("email","==",O)),1)[0],P=null===S||void 0===S||null===(r=S.docs)||void 0===r||null===(e=r[0])||void 0===e?void 0:e.data(),k=D((0,h.Kx)(m.db.collection("chats").doc(w.query.id).collection("messages").orderBy("timestamp","asc")),1)[0];return(0,t.jsxs)(Q,{children:[(0,t.jsxs)(W,{children:[P?(0,t.jsx)(f.Z,{src:null===P||void 0===P?void 0:P.photoURL}):(0,t.jsx)(f.Z,{children:O[0]}),(0,t.jsxs)(Y,{children:[(0,t.jsx)("h3",{children:O}),S?(0,t.jsxs)("p",{children:["Last active: "," ",(null===P||void 0===P?void 0:P.lastSeen.toDate())?J(null===P||void 0===P?void 0:P.lastSeen.toDate()):"Unavailable"]}):"Loading Last Active"]}),(0,t.jsx)(d.Z,{children:(0,t.jsx)(a.Z,{})}),(0,t.jsx)(d.Z,{children:(0,t.jsx)(l.Z,{})})]}),(0,t.jsxs)(nn,{children:[k?k.docs.map((function(n){var r;return(0,t.jsx)(A,{user:n.data().user,message:N({},n.data(),{timestamp:null===(r=n.data().timestamp)||void 0===r?void 0:r.toDate().getTime()})},n.id)})):JSON.parse(i).map((function(n){return(0,t.jsx)(A,{user:n.user,message:n},n.id)})),(0,t.jsx)(rn,{ref:Z})]}),(0,t.jsxs)(en,{children:[(0,t.jsx)(c.Z,{}),(0,t.jsx)(tn,{value:g,onChange:function(n){return j(n.target.value)}}),(0,t.jsx)("button",{type:"submit",onClick:function(n){n.preventDefault(),m.db.collection("users").doc(y.uid).set({lastSeen:U.Z.firestore.FieldValue.serverTimestamp()},{merge:!0}),m.db.collection("chats").doc(w.query.id).collection("messages").add({timestamp:U.Z.firestore.FieldValue.serverTimestamp(),messages:g,user:y.email,photoURL:y.photoURL}),j(""),Z.current.scrollIntoView({behaviour:"smooth",block:"start"})},children:"Send Message"}),(0,t.jsx)(s.Z,{})]})]})},Q=u.ZP.div($()),W=u.ZP.div(K()),Y=u.ZP.div(V()),nn=u.ZP.div(q()),rn=u.ZP.div(X()),en=u.ZP.div(B()),tn=u.ZP.input(G()),on=e(1817);function un(n,r){(null==r||r>n.length)&&(r=n.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=n[e];return t}function an(n,r){return function(n){if(Array.isArray(n))return n}(n)||function(n,r){var e=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var t,i,o=[],u=!0,a=!1;try{for(e=e.call(n);!(u=(t=e.next()).done)&&(o.push(t.value),!r||o.length!==r);u=!0);}catch(l){a=!0,i=l}finally{try{u||null==e.return||e.return()}finally{if(a)throw i}}return o}}(n,r)||function(n,r){if(!n)return;if("string"===typeof n)return un(n,r);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return un(n,r)}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ln(n,r){return r||(r=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(r)}}))}function cn(){var n=ln(["\n  display: flex;\n"]);return cn=function(){return n},n}function sn(){var n=ln(["\n  flex: 1;\n  overflow: scroll;\n  height: 100vh;\n\n  ::-webkit-scrollbar {\n    display: none;\n  }\n  -ms-overflow-style: none;\n  scrollbar-width: none;\n"]);return sn=function(){return n},n}var fn=!0,dn=function(n){var r=n.messages,e=n.chat,u=an((0,o.F_)(m.I),1)[0];return(0,t.jsxs)(pn,{children:[(0,t.jsx)(i.default,{children:(0,t.jsxs)("title",{children:["Chat with ",(0,b.Z)(e.users,u)]})}),(0,t.jsx)(on.Z,{}),(0,t.jsx)(vn,{children:(0,t.jsx)(H,{messages:r,chat:e})})]})},pn=u.ZP.div(cn()),vn=u.ZP.div(sn())},3410:function(n,r){"use strict";r.Z=function(n,r){return null===n||void 0===n?void 0:n.filter((function(n){return n!==(null===r||void 0===r?void 0:r.email)}))[0]}}},function(n){n.O(0,[885,992,279,774,888,179],(function(){return r=7202,n(n.s=r);var r}));var r=n.O();_N_E=r}]);